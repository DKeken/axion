syntax = "proto3";

package axion.billing;

import "common/common.proto";
import "billing/enums.proto";

// Invoice messages
message ListInvoicesRequest {
  axion.common.RequestMetadata metadata = 1;
  string user_id = 2;
  axion.common.Pagination pagination = 3;
}

message GetInvoiceRequest {
  axion.common.RequestMetadata metadata = 1;
  string invoice_id = 2;
}

message Invoice {
  string id = 1;
  string user_id = 2;
  string stripe_invoice_id = 3;
  int64 amount = 4; // В центах
  axion.common.Currency currency = 5;
  InvoiceStatus status = 6;
  int64 period_start = 7;
  int64 period_end = 8;
  int64 created_at = 9;
  int64 paid_at = 10;
  string invoice_url = 11; // URL для скачивания инвойса из Stripe
}

message InvoiceResponse {
  axion.common.Status status = 1;
  oneof result {
    axion.common.Error error = 2;
    Invoice invoice = 3;
  }
}

message ListInvoicesResponse {
  axion.common.Status status = 1;
  oneof result {
    axion.common.Error error = 2;
    ListInvoicesData data = 3;
  }
}

message ListInvoicesData {
  repeated Invoice invoices = 1;
  axion.common.Pagination pagination = 2;
}

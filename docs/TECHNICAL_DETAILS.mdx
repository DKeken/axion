---
title: "–¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ –¥–µ—Ç–∞–ª–∏"
description: "–ö–ª—é—á–µ–≤—ã–µ —Ç–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ –¥–µ—Ç–∞–ª–∏ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏ Axion: –∏–∑–æ–ª—è—Ü–∏—è –∫–æ–Ω—Ç—É—Ä–æ–≤, –¥–µ–ø–ª–æ–π —á–µ—Ä–µ–∑ Runner Agent, —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ SSH, —Ä–∞—Å—á–µ—Ç —Å–∏—Å—Ç–µ–º–Ω—ã—Ö —Ç—Ä–µ–±–æ–≤–∞–Ω–∏–π."
order: 3
---

# –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ –¥–µ—Ç–∞–ª–∏

<Callout type="info" title="–°–≤—è–∑–∞–Ω–Ω—ã–µ –¥–æ–∫—É–º–µ–Ω—Ç—ã">
  –≠—Ç–æ—Ç –¥–æ–∫—É–º–µ–Ω—Ç –¥–æ–ø–æ–ª–Ω—è–µ—Ç [–æ—Å–Ω–æ–≤–Ω—É—é –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—É](./ARCHITECTURE) –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–º–∏
  —Ç–µ—Ö–Ω–∏—á–µ—Å–∫–∏–º–∏ –¥–µ—Ç–∞–ª—è–º–∏ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏.
</Callout>

## –û–±–∑–æ—Ä

–≠—Ç–æ—Ç –¥–æ–∫—É–º–µ–Ω—Ç —Å–æ–¥–µ—Ä–∂–∏—Ç –∫–ª—é—á–µ–≤—ã–µ —Ç–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ –¥–µ—Ç–∞–ª–∏ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏, –∫–æ—Ç–æ—Ä—ã–µ –¥–æ–ø–æ–ª–Ω—è—é—Ç –æ—Å–Ω–æ–≤–Ω—É—é –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—É. –ó–¥–µ—Å—å –æ–ø–∏—Å–∞–Ω—ã –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–µ –º–µ—Ö–∞–Ω–∏–∑–º—ã —Ä–∞–±–æ—Ç—ã —Å–∏—Å—Ç–µ–º—ã.

**–ß—Ç–æ –∑–¥–µ—Å—å –æ–ø–∏—Å–∞–Ω–æ:**

- –ò–∑–æ–ª—è—Ü–∏—è –∫–æ–Ω—Ç—É—Ä–æ–≤ –º–µ–∂–¥—É –ø—Ä–æ–µ–∫—Ç–∞–º–∏
- –î–µ–ø–ª–æ–π –Ω–∞ —Å–µ—Ä–≤–µ—Ä—ã –∫–ª–∏–µ–Ω—Ç–æ–≤ —á–µ—Ä–µ–∑ Runner Agent
- –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ SSH –∏ —É—á–µ—Ç —Å–µ—Ä–≤–µ—Ä–æ–≤
- –î–∏–Ω–∞–º–∏—á–µ—Å–∫–∏–π —Ä–∞—Å—á–µ—Ç —Å–∏—Å—Ç–µ–º–Ω—ã—Ö —Ç—Ä–µ–±–æ–≤–∞–Ω–∏–π
- –£–ø—Ä–æ—â–µ–Ω–Ω–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ –¥–ª—è –≥–µ–Ω–µ—Ä–∏—Ä—É–µ–º—ã—Ö —Å–µ—Ä–≤–∏—Å–æ–≤
- SaaS –ø–ª–∞—Ç—Ñ–æ—Ä–º–∞ –Ω–∞ NestJS microservices
- –°–∏—Å—Ç–µ–º–∞ —Å–±–æ—Ä–∞ –∏ –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è –º–µ—Ç—Ä–∏–∫

## –ò–∑–æ–ª—è—Ü–∏—è –∫–æ–Ω—Ç—É—Ä–æ–≤ –º–µ–∂–¥—É –ø—Ä–æ–µ–∫—Ç–∞–º–∏

### –ö–æ–Ω—Ü–µ–ø—Ü–∏—è

<Callout type="warn" title="–í–∞–∂–Ω–æ">
  –ö–∞–∂–¥—ã–π –ø—Ä–æ–µ–∫—Ç = –ø–æ–ª–Ω–æ—Å—Ç—å—é –∏–∑–æ–ª–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –∫–æ–Ω—Ç—É—Ä. –ü—Ä–æ–µ–∫—Ç—ã –Ω–µ –º–æ–≥—É—Ç –≤–ª–∏—è—Ç—å –¥—Ä—É–≥
  –Ω–∞ –¥—Ä—É–≥–∞ –Ω–∞ –ª—é–±–æ–º —É—Ä–æ–≤–Ω–µ —Å–∏—Å—Ç–µ–º—ã.
</Callout>

**–£—Ä–æ–≤–Ω–∏ –∏–∑–æ–ª—è—Ü–∏–∏:**

1. **Database Level** ‚Äî `project_id` –≤–æ –≤—Å–µ—Ö —Ç–∞–±–ª–∏—Ü–∞—Ö, –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏—è –≤—Å–µ—Ö –∑–∞–ø—Ä–æ—Å–æ–≤
2. **Network Level** ‚Äî –æ—Ç–¥–µ–ª—å–Ω—ã–µ Docker —Å–µ—Ç–∏ –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –ø—Ä–æ–µ–∫—Ç–∞
3. **Resource Level** ‚Äî CPU/Memory limits –Ω–∞ —É—Ä–æ–≤–Ω–µ Docker, –æ—Ç–¥–µ–ª—å–Ω—ã–µ Redis databases
4. **Code Level** ‚Äî –∫–æ–¥ –≤ `generated/{project_id}/`, –∫–∞–∂–¥—ã–π –ø—Ä–æ–µ–∫—Ç = –æ—Ç–¥–µ–ª—å–Ω–∞—è –º–æ–Ω–æ—Ä–µ–ø–∞

### –†–µ–∞–ª–∏–∑–∞—Ü–∏—è

**Database Isolation:**

- Middleware –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –¥–æ–±–∞–≤–ª—è–µ—Ç `project_id` –≤ –∫–∞–∂–¥—ã–π –∑–∞–ø—Ä–æ—Å
- –í—Å–µ SQL –∑–∞–ø—Ä–æ—Å—ã —Ñ–∏–ª—å—Ç—Ä—É—é—Ç—Å—è –ø–æ `project_id`
- –ò–Ω–¥–µ–∫—Å—ã –Ω–∞ `project_id` –¥–ª—è –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏

**Network Isolation:**

- Docker Compose –≥–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç –∏–∑–æ–ª–∏—Ä–æ–≤–∞–Ω–Ω—É—é —Å–µ—Ç—å `axion-project-{project_id}`
- –°–µ—Ä–≤–∏—Å—ã –æ–¥–Ω–æ–≥–æ –ø—Ä–æ–µ–∫—Ç–∞ –Ω–µ –≤–∏–¥—è—Ç —Å–µ—Ä–≤–∏—Å—ã –¥—Ä—É–≥–∏—Ö –ø—Ä–æ–µ–∫—Ç–æ–≤
- HTTP RPC –æ–±—â–µ–Ω–∏–µ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç –≤–Ω—É—Ç—Ä–∏ –∏–∑–æ–ª–∏—Ä–æ–≤–∞–Ω–Ω–æ–π Docker —Å–µ—Ç–∏

**Resource Isolation:**

- Docker resource limits –≤ `docker-compose.yml` –¥–ª—è –∫–∞–∂–¥–æ–≥–æ —Å–µ—Ä–≤–∏—Å–∞
- –û—Ç–¥–µ–ª—å–Ω—ã–µ Redis databases –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –ø—Ä–æ–µ–∫—Ç–∞
- –û–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ: –æ—Ç–¥–µ–ª—å–Ω—ã–µ PostgreSQL schemas

**Code Isolation:**

- –ö–∞–∂–¥—ã–π –ø—Ä–æ–µ–∫—Ç = –æ—Ç–¥–µ–ª—å–Ω–∞—è –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—è –≤ `generated/`
- –°–æ–±—Å—Ç–≤–µ–Ω–Ω—ã–µ –∫–æ–Ω—Ç—Ä–∞–∫—Ç—ã –∏ —Ç–∏–ø—ã
- –ü–æ–ª–Ω–∞—è –Ω–µ–∑–∞–≤–∏—Å–∏–º–æ—Å—Ç—å –ø—Ä–æ–µ–∫—Ç–æ–≤

–ü–æ–¥—Ä–æ–±–Ω–µ–µ: —Ä–∞–∑–¥–µ–ª "Project Isolation" –≤ [`ARCHITECTURE`](./ARCHITECTURE#-project-isolation-–ø—Ä–æ–µ–∫—Ç-–∫–∞–∫-–∏–∑–æ–ª–∏—Ä–æ–≤–∞–Ω–Ω—ã–π-–∫–æ–Ω—Ç—É—Ä)

---

## üöÄ –î–µ–ø–ª–æ–π –Ω–∞ –°–µ—Ä–≤–µ—Ä—ã –ö–ª–∏–µ–Ω—Ç–æ–≤ (—á–µ—Ä–µ–∑ Axion Runner Agent)

–î–µ–ø–ª–æ–π –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è —á–µ—Ä–µ–∑ **Axion Runner Agent** ‚Äî Rust –∞–≥–µ–Ω—Ç –Ω–∞ —Å–µ—Ä–≤–µ—Ä–∞—Ö –∫–ª–∏–µ–Ω—Ç–æ–≤, –∫–æ—Ç–æ—Ä—ã–π —É–ø—Ä–∞–≤–ª—è–µ—Ç Docker Swarm –ª–æ–∫–∞–ª—å–Ω–æ.

**–ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞:**

```
Control Plane ‚Üí BullMQ ‚Üí Deployment Service ‚Üí gRPC + Kafka ‚Üí Runner Agent ‚Üí Docker Swarm
                                                                        ‚Üì
                                                              –¢–µ–ª–µ–º–µ—Ç—Ä–∏—è ‚Üí Control Plane (gRPC)
```

**–ü—Ä–æ—Ü–µ—Å—Å –¥–µ–ø–ª–æ—è:**

1. –°–æ–∑–¥–∞–Ω–∏–µ –∑–∞–¥–∞—á–∏ –≤ BullMQ —Å retry –º–µ—Ö–∞–Ω–∏–∑–º–æ–º
2. –ü–æ–ª—É—á–µ–Ω–∏–µ —Å–µ—Ä–≤–µ—Ä–æ–≤ –∏ –ø—Ä–æ–≤–µ—Ä–∫–∞ Runner Agent
3. –ì–µ–Ω–µ—Ä–∞—Ü–∏—è Docker Swarm Stack –¥–ª—è –∫–∞–∂–¥–æ–≥–æ —Å–µ—Ä–≤–µ—Ä–∞
4. –û—Ç–ø—Ä–∞–≤–∫–∞ –∫–æ–º–∞–Ω–¥—ã —á–µ—Ä–µ–∑ gRPC + Kafka –∫ Runner Agent
5. Runner Agent –≤—ã–ø–æ–ª–Ω—è–µ—Ç `docker stack deploy` –ª–æ–∫–∞–ª—å–Ω–æ
6. –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –¥–µ–ø–ª–æ—è —á–µ—Ä–µ–∑ Agent (health checks, –º–µ—Ç—Ä–∏–∫–∏)
7. –í–∞–ª–∏–¥–∞—Ü–∏—è —É—Å–ø–µ—à–Ω–æ—Å—Ç–∏ –¥–µ–ø–ª–æ—è

**–£—Å—Ç–∞–Ω–æ–≤–∫–∞ Runner Agent:**

–ê–≥–µ–Ω—Ç —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø—Ä–∏ –¥–æ–±–∞–≤–ª–µ–Ω–∏–∏ —Å–µ—Ä–≤–µ—Ä–∞ —á–µ—Ä–µ–∑ SSH + BullMQ. –û–¥–∏–Ω —Å—Ç–∞—Ç–∏—á–µ—Å–∫–∏–π –±–∏–Ω–∞—Ä–Ω–∏–∫ —Ä–∞–±–æ—Ç–∞–µ—Ç –Ω–∞ –ª—é–±–æ–º Linux –±–µ–∑ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π.

–ü–æ–¥—Ä–æ–±–Ω–µ–µ: [`RUNNER_AGENT.md`](./RUNNER_AGENT)

---

## üîê –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ SSH –∏ –°–µ—Ä–≤–µ—Ä–∞–º–∏

### –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞

```
Infrastructure Service ‚Üí PostgreSQL (servers) ‚Üí SSH Service ‚Üí Client Servers
```

**–ó–∞—á–µ–º –æ—Ç–¥–µ–ª—å–Ω—ã–π —Å–µ—Ä–≤–∏—Å?**

- –¶–µ–Ω—Ç—Ä–∞–ª–∏–∑–æ–≤–∞–Ω–Ω–æ–µ —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –≤—Å–µ–º–∏ —Å–µ—Ä–≤–µ—Ä–∞–º–∏
- –ë–µ–∑–æ–ø–∞—Å–Ω–æ–µ —Ö—Ä–∞–Ω–µ–Ω–∏–µ SSH –∫–ª—é—á–µ–π
- –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –∑–¥–æ—Ä–æ–≤—å—è —Å–µ—Ä–≤–µ—Ä–æ–≤
- **–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è —É—Å—Ç–∞–Ω–æ–≤–∫–∞ Runner Agent** –ø—Ä–∏ –¥–æ–±–∞–≤–ª–µ–Ω–∏–∏ —Å–µ—Ä–≤–µ—Ä–∞
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∞ –Ω–æ–≤—ã—Ö —Å–µ—Ä–≤–µ—Ä–æ–≤

### Database Schema

**–¢–∞–±–ª–∏—Ü–∞ `servers`:**

- –ú–µ—Ç–∞–¥–∞–Ω–Ω—ã–µ —Å–µ—Ä–≤–µ—Ä–æ–≤ (host, port, username)
- –ó–∞—à–∏—Ñ—Ä–æ–≤–∞–Ω–Ω—ã–µ SSH private keys (AES-256-GCM)
- –°—Ç–∞—Ç—É—Å –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∏ –ø–æ—Å–ª–µ–¥–Ω—è—è –æ—à–∏–±–∫–∞
- –°–∏—Å—Ç–µ–º–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è (OS, Docker version, CPU, Memory)
- –°–≤—è–∑—å —Å –∫–ª–∞—Å—Ç–µ—Ä–æ–º (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)

**–¢–∞–±–ª–∏—Ü–∞ `server_connection_logs`:**

- –ò—Å—Ç–æ—Ä–∏—è –≤—Å–µ—Ö –ø–æ–ø—ã—Ç–æ–∫ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è
- –°—Ç–∞—Ç—É—Å (success/failed/timeout)
- –í—Ä–µ–º—è –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è
- –°–æ–æ–±—â–µ–Ω–∏—è –æ–± –æ—à–∏–±–∫–∞—Ö

### –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å

**–®–∏—Ñ—Ä–æ–≤–∞–Ω–∏–µ SSH –∫–ª—é—á–µ–π:**

- **–ê–ª–≥–æ—Ä–∏—Ç–º:** AES-256-GCM (authenticated encryption)
- **–ö–ª—é—á:** –≥–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç—Å—è –∏–∑ `SSH_ENCRYPTION_MASTER_KEY` —á–µ—Ä–µ–∑ scrypt
- **–•—Ä–∞–Ω–µ–Ω–∏–µ:** –∑–∞—à–∏—Ñ—Ä–æ–≤–∞–Ω–Ω—ã–µ –∫–ª—é—á–∏ –≤ PostgreSQL
- **–î–æ—Å—Ç—É–ø:** —Ç–æ–ª—å–∫–æ —á–µ—Ä–µ–∑ Infrastructure Service API —Å –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–µ–π

**–ó–∞—â–∏—Ç–∞ –¥–æ—Å—Ç—É–ø–∞:**

- –í—Å–µ –æ–ø–µ—Ä–∞—Ü–∏–∏ —Ç—Ä–µ–±—É—é—Ç –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
- –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø—Ä–∞–≤ –¥–æ—Å—Ç—É–ø–∞ –∫ —Å–µ—Ä–≤–µ—Ä—É (`user_id`)
- –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –≤—Å–µ—Ö –æ–ø–µ—Ä–∞—Ü–∏–π

### SSH Service

**Connection Pooling:**

- –ü–µ—Ä–µ–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ SSH —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–π –¥–ª—è –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –∑–∞–∫—Ä—ã—Ç–∏–µ –Ω–µ–∞–∫—Ç–∏–≤–Ω—ã—Ö —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–π
- –ú–∞–∫—Å–∏–º—É–º 3 —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è –Ω–∞ —Å–µ—Ä–≤–µ—Ä

**–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ:**

- –ü—Ä–∏ –¥–æ–±–∞–≤–ª–µ–Ω–∏–∏ —Å–µ—Ä–≤–µ—Ä–∞ ‚Äî –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è
- –ü–æ–ª—É—á–µ–Ω–∏–µ —Å–∏—Å—Ç–µ–º–Ω–æ–π –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ (OS, Docker, —Ä–µ—Å—É—Ä—Å—ã)
- –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –º–µ—Ç–∞–¥–∞–Ω–Ω—ã—Ö –≤ –ë–î

**–ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –∑–¥–æ—Ä–æ–≤—å—è:**

- –ü—Ä–æ–≤–µ—Ä–∫–∞ –∫–∞–∂–¥—ã–µ 5 –º–∏–Ω—É—Ç –¥–ª—è –≤—Å–µ—Ö –ø–æ–¥–∫–ª—é—á–µ–Ω–Ω—ã—Ö —Å–µ—Ä–≤–µ—Ä–æ–≤
- –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å—Ç–∞—Ç—É—Å–∞ –ø—Ä–∏ –ø—Ä–æ–±–ª–µ–º–∞—Ö
- –£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é –ø—Ä–∏ –Ω–µ–¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç–∏

**–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∞:**

- –ü—Ä–∏ –ø–µ—Ä–≤–æ–º –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–∏ –ø—Ä–æ–≤–µ—Ä–∫–∞/—É—Å—Ç–∞–Ω–æ–≤–∫–∞ Docker
- **–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è —É—Å—Ç–∞–Ω–æ–≤–∫–∞ Runner Agent** —á–µ—Ä–µ–∑ BullMQ:
  1. –°–æ–∑–¥–∞–Ω–∏–µ –∑–∞–¥–∞—á–∏ –≤ –æ—á–µ—Ä–µ–¥–∏ `agent-installation`
  2. Worker –ø–æ–¥–∫–ª—é—á–∞–µ—Ç—Å—è —á–µ—Ä–µ–∑ SSH
  3. –û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—ã —Å–µ—Ä–≤–µ—Ä–∞
  4. –ó–∞–≥—Ä—É–∑–∫–∞ —Å—Ç–∞—Ç–∏—á–µ—Å–∫–æ–≥–æ –±–∏–Ω–∞—Ä–Ω–∏–∫–∞ –∞–≥–µ–Ω—Ç–∞
  5. –£—Å—Ç–∞–Ω–æ–≤–∫–∞ systemd service
  6. –ó–∞–ø—É—Å–∫ –∏ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è –∞–≥–µ–Ω—Ç–∞
- –°–æ–∑–¥–∞–Ω–∏–µ –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã—Ö –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–π
- –ù–∞—Å—Ç—Ä–æ–π–∫–∞ firewall (–µ—Å–ª–∏ –Ω—É–∂–Ω–æ)
- –°–æ–∑–¥–∞–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è `axion` –¥–ª—è –∑–∞–ø—É—Å–∫–∞ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–æ–≤

### –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –°–µ—Ä–≤–µ—Ä–∞

–ü—Ä–∏ –ø–µ—Ä–≤–æ–º –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–∏ –∫ –Ω–æ–≤–æ–º—É —Å–µ—Ä–≤–µ—Ä—É —Å–∏—Å—Ç–µ–º–∞ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏:

1. **–ü—Ä–æ–≤–µ—Ä—è–µ—Ç Docker:**
   - –ï—Å–ª–∏ –Ω–µ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω ‚Äî —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç —á–µ—Ä–µ–∑ –æ—Ñ–∏—Ü–∏–∞–ª—å–Ω—ã–π —Å–∫—Ä–∏–ø—Ç
   - –ü—Ä–æ–≤–µ—Ä—è–µ—Ç –≤–µ—Ä—Å–∏—é –∏ –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç—å
   - –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ—Ç Docker Swarm –µ—Å–ª–∏ –Ω—É–∂–Ω–æ

2. **–£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç Runner Agent:**
   - –°–æ–∑–¥–∞–µ—Ç –∑–∞–¥–∞—á—É –≤ BullMQ –æ—á–µ—Ä–µ–¥–∏ `agent-installation`
   - Worker –ø–æ–¥–∫–ª—é—á–∞–µ—Ç—Å—è —á–µ—Ä–µ–∑ SSH
   - –û–ø—Ä–µ–¥–µ–ª—è–µ—Ç –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—É —Å–µ—Ä–≤–µ—Ä–∞ (x86_64, aarch64)
   - –ì–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç —É–Ω–∏–∫–∞–ª—å–Ω—ã–π —Ç–æ–∫–µ–Ω –∞–≥–µ–Ω—Ç–∞
   - –ó–∞–≥—Ä—É–∂–∞–µ—Ç —Å—Ç–∞—Ç–∏—á–µ—Å–∫–∏–π –±–∏–Ω–∞—Ä–Ω–∏–∫ –∞–≥–µ–Ω—Ç–∞
   - –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç systemd service
   - –ó–∞–ø—É—Å–∫–∞–µ—Ç –∞–≥–µ–Ω—Ç–∞
   - –†–µ–≥–∏—Å—Ç—Ä–∏—Ä—É–µ—Ç –∞–≥–µ–Ω—Ç–∞ –≤ Control Plane

3. **–°–æ–∑–¥–∞–µ—Ç —Å—Ç—Ä—É–∫—Ç—É—Ä—É:**
   - –î–∏—Ä–µ–∫—Ç–æ—Ä–∏—è `/opt/axion/projects` –¥–ª—è –ø—Ä–æ–µ–∫—Ç–æ–≤
   - –î–∏—Ä–µ–∫—Ç–æ—Ä–∏—è `/etc/axion` –¥–ª—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏
   - –î–∏—Ä–µ–∫—Ç–æ—Ä–∏—è `/var/log/axion` –¥–ª—è –ª–æ–≥–æ–≤
   - –ù–µ–æ–±—Ö–æ–¥–∏–º—ã–µ –ø—Ä–∞–≤–∞ –¥–æ—Å—Ç—É–ø–∞

4. **–°–æ–∑–¥–∞–µ—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è:**
   - –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å `axion` –¥–ª—è –∑–∞–ø—É—Å–∫–∞ –∞–≥–µ–Ω—Ç–∞ –∏ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–æ–≤
   - –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –≤ –≥—Ä—É–ø–ø—É `docker`

5. **–ù–∞—Å—Ç—Ä–∞–∏–≤–∞–µ—Ç firewall (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ):**
   - –û—Ç–∫—Ä—ã–≤–∞–µ—Ç –ø–æ—Ä—Ç—ã: 22 (SSH), 80 (HTTP), 443 (HTTPS)
   - –ù–∞—Å—Ç—Ä–∞–∏–≤–∞–µ—Ç –ø—Ä–∞–≤–∏–ª–∞ –¥–ª—è Docker Swarm

---

## –†–∞—Å—á–µ—Ç —Å–∏—Å—Ç–µ–º–Ω—ã—Ö —Ç—Ä–µ–±–æ–≤–∞–Ω–∏–π

### –ó–∞—á–µ–º —ç—Ç–æ –Ω—É–∂–Ω–æ?

| –ó–∞–¥–∞—á–∞                     | –û–ø–∏—Å–∞–Ω–∏–µ                                                  |
| -------------------------- | --------------------------------------------------------- |
| **–ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–µ—Å—É—Ä—Å–æ–≤**      | –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –ª–∏ —Ä–µ—Å—É—Ä—Å–æ–≤ –¥–ª—è –¥–µ–ø–ª–æ—è               |
| **–†–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ —Å–µ—Ä–≤–∏—Å–æ–≤** | –ü—Ä–µ–¥–ª–æ–∂–∏—Ç—å –æ–ø—Ç–∏–º–∞–ª—å–Ω–æ–µ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ —Å–µ—Ä–≤–∏—Å–æ–≤ –ø–æ —Å–µ—Ä–≤–µ—Ä–∞–º |
| **–ú–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏–µ**        | –†–µ–∫–æ–º–µ–Ω–¥–æ–≤–∞—Ç—å –º–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏–µ –ø—Ä–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏           |
| **–û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è**            | –û–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞—Ç—å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ —Ä–µ—Å—É—Ä—Å–æ–≤                     |

### –ú–µ—Ç—Ä–∏–∫–∏

| –ú–µ—Ç—Ä–∏–∫–∞     | –ï–¥–∏–Ω–∏—Ü–∞ –∏–∑–º–µ—Ä–µ–Ω–∏—è              | –ò—Å—Ç–æ—á–Ω–∏–∫                                   |
| ----------- | ------------------------------ | ------------------------------------------ |
| **CPU**     | cores, —É—Ç–∏–ª–∏–∑–∞—Ü–∏—è (%)          | SSH –∫–æ–º–∞–Ω–¥—ã (`top`), Docker stats          |
| **Memory**  | total/used/available (MB)      | SSH –∫–æ–º–∞–Ω–¥—ã (`free`), Docker stats         |
| **Disk**    | total/used/available (GB)      | SSH –∫–æ–º–∞–Ω–¥—ã (`df`), Docker stats           |
| **Network** | bandwidth (Mbps), latency (ms) | Prometheus (–µ—Å–ª–∏ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω), Docker stats |

### –ü—Ä–æ—Ü–µ—Å—Å —Ä–∞—Å—á–µ—Ç–∞

| –®–∞–≥                              | –î–µ–π—Å—Ç–≤–∏–µ                                                  | –†–µ–∑—É–ª—å—Ç–∞—Ç                                |
| -------------------------------- | --------------------------------------------------------- | ---------------------------------------- |
| **1. –ü–æ–ª—É—á–µ–Ω–∏–µ —Å–µ—Ä–≤–∏—Å–æ–≤**        | –í—Å–µ —Å–µ—Ä–≤–∏—Å—ã –∏–∑ `project_services` —Å–æ —Å—Ç–∞—Ç—É—Å–æ–º `validated` | –°–ø–∏—Å–æ–∫ —Å–µ—Ä–≤–∏—Å–æ–≤ —Å –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–µ–π —Ä–µ—Å—É—Ä—Å–æ–≤ |
| **2. –ü–æ–ª—É—á–µ–Ω–∏–µ –º–µ—Ç—Ä–∏–∫ —Å–µ—Ä–≤–µ—Ä–æ–≤** | –°–±–æ—Ä –º–µ—Ç—Ä–∏–∫ —á–µ—Ä–µ–∑ SSH (–∏–ª–∏ –∏–∑ –∫–ª–∞—Å—Ç–µ—Ä–∞)                   | –¢–µ–∫—É—â–∏–µ –º–µ—Ç—Ä–∏–∫–∏ –≤—Å–µ—Ö —Å–µ—Ä–≤–µ—Ä–æ–≤            |
| **3. –†–∞—Å—á–µ—Ç —Ç—Ä–µ–±–æ–≤–∞–Ω–∏–π**         | –ë–∞–∑–æ–≤—ã–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è + —É—á–µ—Ç –Ω–∞–≥—Ä—É–∑–∫–∏ + —Ä–µ–ø–ª–∏–∫–∏              | –¢—Ä–µ–±–æ–≤–∞–Ω–∏—è –¥–ª—è –∫–∞–∂–¥–æ–≥–æ —Å–µ—Ä–≤–∏—Å–∞           |
| **4. –ê–≥—Ä–µ–≥–∞—Ü–∏—è**                 | –°—É–º–º–∏—Ä–æ–≤–∞–Ω–∏–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏–π + –∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä–∞                  | –û–±—â–∏–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è –ø—Ä–æ–µ–∫—Ç–∞                 |
| **5. –ü—Ä–æ–≤–µ—Ä–∫–∞ –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç–∏**      | –°—Ä–∞–≤–Ω–µ–Ω–∏–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏–π —Å –¥–æ—Å—Ç—É–ø–Ω—ã–º–∏ —Ä–µ—Å—É—Ä—Å–∞–º–∏               | –î–µ—Ñ–∏—Ü–∏—Ç —Ä–µ—Å—É—Ä—Å–æ–≤ (–µ—Å–ª–∏ –µ—Å—Ç—å)             |
| **6. –ì–µ–Ω–µ—Ä–∞—Ü–∏—è —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–π**    | –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –ø–æ –º–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏—é –∏ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—é           | –û–ø—Ç–∏–º–∞–ª—å–Ω–∞—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è                 |

### –î–µ—Ç–∞–ª–∏ —Ä–∞—Å—á–µ—Ç–∞

#### –®–∞–≥ 3: –†–∞—Å—á–µ—Ç —Ç—Ä–µ–±–æ–≤–∞–Ω–∏–π –¥–ª—è —Å–µ—Ä–≤–∏—Å–∞

| –§–∞–∫—Ç–æ—Ä                 | –§–æ—Ä–º—É–ª–∞                          | –ü—Ä–∏–º–µ—Ä                        |
| ---------------------- | -------------------------------- | ----------------------------- |
| **–ë–∞–∑–æ–≤—ã–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è** | –ò–∑ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ —Å–µ—Ä–≤–∏—Å–∞          | CPU: 0.5 cores, Memory: 512MB |
| **–£—á–µ—Ç –Ω–∞–≥—Ä—É–∑–∫–∏**      | Multiplier –µ—Å–ª–∏ —É—Ç–∏–ª–∏–∑–∞—Ü–∏—è > 80% | 1.5x –ø—Ä–∏ –≤—ã—Å–æ–∫–æ–π –Ω–∞–≥—Ä—É–∑–∫–µ     |
| **–†–µ–ø–ª–∏–∫–∏**            | –£–º–Ω–æ–∂–µ–Ω–∏–µ –Ω–∞ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Ä–µ–ø–ª–∏–∫   | 2 —Ä–µ–ø–ª–∏–∫–∏ = 2x —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è     |
| **Network bandwidth**  | –û—Ü–µ–Ω–∫–∞ –Ω–∞ –æ—Å–Ω–æ–≤–µ —Å–≤—è–∑–µ–π          | –ó–∞–≤–∏—Å–∏—Ç –æ—Ç –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ edges   |

### –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –ú–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏–µ

**–ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥:**

- –ü—Ä–æ–≤–µ—Ä–∫–∞ –∫–∞–∂–¥—ã–µ 5 –º–∏–Ω—É—Ç –¥–ª—è –≤—Å–µ—Ö –∞–∫—Ç–∏–≤–Ω—ã—Ö –ø—Ä–æ–µ–∫—Ç–æ–≤
- –°—Ä–∞–≤–Ω–µ–Ω–∏–µ —Ç–µ–∫—É—â–∏—Ö –º–µ—Ç—Ä–∏–∫ —Å —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è–º–∏

**–î–µ–π—Å—Ç–≤–∏—è:**

- –ï—Å–ª–∏ —Ä–µ—Å—É—Ä—Å–æ–≤ –Ω–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ ‚Äî —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é
- –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –ø–æ –¥–æ–±–∞–≤–ª–µ–Ω–∏—é —Å–µ—Ä–≤–µ—Ä–æ–≤ –≤ –∫–ª–∞—Å—Ç–µ—Ä
- –ü—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–µ –æ–ø—Ç–∏–º–∞–ª—å–Ω–æ–π –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏

**–û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è:**

- –°–∏—Å—Ç–µ–º–∞ –Ω–µ –¥–æ–±–∞–≤–ª—è–µ—Ç —Å–µ—Ä–≤–µ—Ä—ã –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ (—Ç—Ä–µ–±—É–µ—Ç—Å—è –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ)
- –¢–æ–ª—å–∫–æ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –∏ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è

---

## –£–ø—Ä–æ—â–µ–Ω–Ω–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ –≥–µ–Ω–µ—Ä–∏—Ä—É–µ–º—ã—Ö —Å–µ—Ä–≤–∏—Å–æ–≤

### –ü–æ—á–µ–º—É –Ω–µ NestJS?

**–ü—Ä–æ–±–ª–µ–º—ã NestJS –¥–ª—è –≥–µ–Ω–µ—Ä–∏—Ä—É–µ–º—ã—Ö —Å–µ—Ä–≤–∏—Å–æ–≤:**

- –°–ª–∏—à–∫–æ–º –º–Ω–æ–≥–æ boilerplate –∫–æ–¥–∞
- –°–ª–æ–∂–Ω–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ –¥–ª—è –ø—Ä–æ—Å—Ç—ã—Ö —Å–µ—Ä–≤–∏—Å–æ–≤
- –¢—è–∂–µ–ª—ã–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ (–º–Ω–æ–≥–æ npm –ø–∞–∫–µ—Ç–æ–≤)
- –ú–µ–¥–ª–µ–Ω–Ω—ã–π —Å—Ç–∞—Ä—Ç –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
- –ò–∑–±—ã—Ç–æ—á–Ω–æ—Å—Ç—å –¥–ª—è –±–æ–ª—å—à–∏–Ω—Å—Ç–≤–∞ —Å–ª—É—á–∞–µ–≤

**–†–µ—à–µ–Ω–∏–µ: –ª–µ–≥–∫–æ–≤–µ—Å–Ω—ã–π —Ñ—Ä–µ–π–º–≤–æ—Ä–∫**

–î–ª—è –≥–µ–Ω–µ—Ä–∏—Ä—É–µ–º—ã—Ö —Å–µ—Ä–≤–∏—Å–æ–≤ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –ª–µ–≥–∫–æ–≤–µ—Å–Ω—ã–π –ø–æ–¥—Ö–æ–¥:

- **ElysiaJS –∏–ª–∏ Hono** ‚Äî –º–∏–Ω–∏–º–∞–ª–∏—Å—Ç–∏—á–Ω—ã–µ HTTP —Ñ—Ä–µ–π–º–≤–æ—Ä–∫–∏
- **HTTP RPC** ‚Äî –¥–ª—è –º–µ–∂—Å–µ—Ä–≤–∏—Å–Ω–æ–≥–æ –æ–±—â–µ–Ω–∏—è —á–µ—Ä–µ–∑ –≤–Ω—É—Ç—Ä–µ–Ω–Ω–∏–π IP Docker Swarm (DNS –ø–æ –∏–º–µ–Ω–∏ —Å–µ—Ä–≤–∏—Å–∞)
- **Drizzle ORM** ‚Äî –ª–µ–≥–∫–æ–≤–µ—Å–Ω–∞—è —Ä–∞–±–æ—Ç–∞ —Å –ë–î
- **Protobuf** ‚Äî —Ç–∏–ø–æ–±–µ–∑–æ–ø–∞—Å–Ω—ã–µ –∫–æ–Ω—Ç—Ä–∞–∫—Ç—ã

### –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –°–µ—Ä–≤–∏—Å–∞

```
src/
‚îú‚îÄ‚îÄ main.ts              # –¢–æ—á–∫–∞ –≤—Ö–æ–¥–∞ (Elysia/Hono app)
‚îú‚îÄ‚îÄ config/              # –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è (env variables)
‚îú‚îÄ‚îÄ messaging/           # HTTP RPC –∫–ª–∏–µ–Ω—Ç/—Å–µ—Ä–≤–µ—Ä
‚îÇ   ‚îú‚îÄ‚îÄ client.ts        # –ö–ª–∏–µ–Ω—Ç –¥–ª—è –≤—ã–∑–æ–≤–∞ –¥—Ä—É–≥–∏—Ö —Å–µ—Ä–≤–∏—Å–æ–≤
‚îÇ   ‚îú‚îÄ‚îÄ server.ts        # –°–µ—Ä–≤–µ—Ä –¥–ª—è –æ–±—Ä–∞–±–æ—Ç–∫–∏ –∑–∞–ø—Ä–æ—Å–æ–≤
‚îÇ   ‚îî‚îÄ‚îÄ contracts.ts     # Protobuf –∫–æ–Ω—Ç—Ä–∞–∫—Ç—ã
‚îú‚îÄ‚îÄ database/            # –†–∞–±–æ—Ç–∞ —Å –ë–î
‚îÇ   ‚îú‚îÄ‚îÄ schema.ts        # Drizzle schema
‚îÇ   ‚îú‚îÄ‚îÄ repository.ts    # Repository pattern
‚îÇ   ‚îî‚îÄ‚îÄ migrations/      # –ú–∏–≥—Ä–∞—Ü–∏–∏ –ë–î
‚îú‚îÄ‚îÄ modules/             # –ë–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫–∞
‚îÇ   ‚îî‚îÄ‚îÄ {entity}/        # –ú–æ–¥—É–ª—å —Å—É—â–Ω–æ—Å—Ç–∏
‚îÇ       ‚îú‚îÄ‚îÄ {entity}.service.ts  # LLM –≥–µ–Ω–µ—Ä–∏—Ç –¢–û–õ–¨–ö–û —ç—Ç–æ
‚îÇ       ‚îî‚îÄ‚îÄ {entity}.handler.ts  # HTTP RPC handlers (–∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏)
‚îî‚îÄ‚îÄ health/              # Health checks
    ‚îî‚îÄ‚îÄ health.check.ts  # Health endpoint
```

### –ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞

| –ö–∞—Ç–µ–≥–æ—Ä–∏—è              | –ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–æ              | –†–µ–∑—É–ª—å—Ç–∞—Ç                            |
| ---------------------- | ------------------------- | ------------------------------------ |
| **–ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å** | –ú–∏–Ω–∏–º—É–º –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π      | –ë—ã—Å—Ç—Ä–∞—è —É—Å—Ç–∞–Ω–æ–≤–∫–∞ –∏ —Å—Ç–∞—Ä—Ç –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è |
| **–ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å** | –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç             | –ù–∏–∑–∫–æ–µ –ø–æ—Ç—Ä–µ–±–ª–µ–Ω–∏–µ –ø–∞–º—è—Ç–∏            |
| **–ü—Ä–æ—Å—Ç–æ—Ç–∞**           | –ü—Ä–æ—Å—Ç–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞         | –õ–µ–≥–∫–æ –ø–æ–Ω—è—Ç—å –∏ –æ—Ç–ª–∞–¥–∏—Ç—å              |
| **–ü—Ä–æ—Å—Ç–æ—Ç–∞**           | –ú–µ–Ω—å—à–µ —Ç–æ—á–µ–∫ –æ—Ç–∫–∞–∑–∞       | –ë–æ–ª–µ–µ –Ω–∞–¥–µ–∂–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞               |
| **–ì–∏–±–∫–æ—Å—Ç—å**           | –õ–µ–≥–∫–æ –∫–∞—Å—Ç–æ–º–∏–∑–∏—Ä–æ–≤–∞—Ç—å     | –ü—Ä–æ—Å—Ç–æ–µ –¥–æ–±–∞–≤–ª–µ–Ω–∏–µ —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç–∏  |
| **–ì–∏–±–∫–æ—Å—Ç—å**           | –ù–µ –ø—Ä–∏–≤—è–∑–∞–Ω—ã –∫ —Ñ—Ä–µ–π–º–≤–æ—Ä–∫—É | –°–≤–æ–±–æ–¥–∞ –≤—ã–±–æ—Ä–∞ —Ç–µ—Ö–Ω–æ–ª–æ–≥–∏–π            |

–ü–æ–¥—Ä–æ–±–Ω–µ–µ: [`templates/blueprints/service/`](./templates/blueprints/service/)

---

## SaaS –ü–ª–∞—Ç—Ñ–æ—Ä–º–∞: NestJS Microservices

### –ü–æ—á–µ–º—É NestJS –¥–ª—è –ø–ª–∞—Ç—Ñ–æ—Ä–º—ã?

| –¢—Ä–µ–±–æ–≤–∞–Ω–∏–µ                        | –†–µ—à–µ–Ω–∏–µ NestJS                              |
| --------------------------------- | ------------------------------------------- |
| **–°–ª–æ–∂–Ω–∞—è –±–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫–∞**         | –ú–æ–¥—É–ª—å–Ω–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞, Dependency Injection |
| **–ú–Ω–æ–∂–µ—Å—Ç–≤–æ –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–π**          | LLM, Stripe, SSH ‚Äî –≤—Å–µ —á–µ—Ä–µ–∑ –º–æ–¥—É–ª–∏         |
| **–ù–∞–¥–µ–∂–Ω–æ—Å—Ç—å –∏ –º–∞—Å—à—Ç–∞–±–∏—Ä—É–µ–º–æ—Å—Ç—å** | –í—Å—Ç—Ä–æ–µ–Ω–Ω–∞—è –ø–æ–¥–¥–µ—Ä–∂–∫–∞ microservices          |
| **Enterprise-grade**              | –ü—Ä–æ–≤–µ—Ä–µ–Ω–Ω—ã–µ –ø–∞—Ç—Ç–µ—Ä–Ω—ã, –±–æ–ª—å—à–∞—è —ç–∫–æ—Å–∏—Å—Ç–µ–º–∞    |

| –ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–æ              | –û–ø–∏—Å–∞–Ω–∏–µ                           |
| ------------------------- | ---------------------------------- |
| **–ú–æ–¥—É–ª—å–Ω–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞** | –õ–µ–≥–∫–æ –æ—Ä–≥–∞–Ω–∏–∑–æ–≤–∞—Ç—å –∫–æ–¥ –ø–æ –¥–æ–º–µ–Ω–∞–º  |
| **Microservices**         | –í—Å—Ç—Ä–æ–µ–Ω–Ω–∞—è –ø–æ–¥–¥–µ—Ä–∂–∫–∞ –∏–∑ –∫–æ—Ä–æ–±–∫–∏    |
| **TypeScript**            | –ü–æ–ª–Ω–∞—è —Ç–∏–ø–æ–±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å            |
| **–≠–∫–æ—Å–∏—Å—Ç–µ–º–∞**            | –ë–æ–ª—å—à–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –≥–æ—Ç–æ–≤—ã—Ö –º–æ–¥—É–ª–µ–π |
| **–ü–∞—Ç—Ç–µ—Ä–Ω—ã**              | –ü—Ä–æ–≤–µ—Ä–µ–Ω–Ω—ã–µ –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–Ω—ã–µ —Ä–µ—à–µ–Ω–∏—è  |

### –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞

```
Traefik ‚Üí Next.js Frontend ‚Üí NestJS Microservices ‚Üí Kafka/Redis/PostgreSQL
```

| –ö–æ–º–ø–æ–Ω–µ–Ω—Ç                | –ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ       | –ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞                                   |
| ------------------------ | ---------------- | ---------------------------------------------- |
| **Traefik**              | Edge routing     | SSL termination, load balancing, rate limiting |
| **Next.js Frontend**     | SSR –∏ UI         | SEO, React 19 RSC, –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å          |
| **NestJS Microservices** | –ë–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫–∞    | –ú–æ–¥—É–ª—å–Ω–æ—Å—Ç—å, –º–∞—Å—à—Ç–∞–±–∏—Ä—É–µ–º–æ—Å—Ç—å                  |
| **Kafka**                | Event bus        | –ù–∞–¥–µ–∂–Ω–æ—Å—Ç—å, CQRS, –≥–∞—Ä–∞–Ω—Ç–∏—è –¥–æ—Å—Ç–∞–≤–∫–∏            |
| **Redis/KeyDB**          | Infra dependency | –ö—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ, –≤—Ä–µ–º–µ–Ω–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ, BullMQ queues   |
| **PostgreSQL**           | –•—Ä–∞–Ω–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö  | –ù–∞–¥–µ–∂–Ω–æ—Å—Ç—å, ACID —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏                    |

### –ö–æ–º–ø–æ–Ω–µ–Ω—Ç—ã –ø–ª–∞—Ç—Ñ–æ—Ä–º—ã

| –ö–æ–º–ø–æ–Ω–µ–Ω—Ç                  | –ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ                 | –¢–µ—Ö–Ω–æ–ª–æ–≥–∏–∏                                         |
| -------------------------- | -------------------------- | -------------------------------------------------- |
| **Traefik**                | Edge routing               | Load balancing, SSL (Let's Encrypt), Rate limiting |
| **Next.js Frontend**       | UI –∏ SSR                   | React 19 RSC, Better Auth, SSE, React Flow         |
| **Graph Service**          | –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –≥—Ä–∞—Ñ–∞–º–∏         | Drizzle ORM, –≤–µ—Ä—Å–∏–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ, SSE                  |
| **Codegen Service**        | –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –∫–æ–¥–∞             | LLM (OpenRouter), Blueprint System, Handlebars     |
| **Deployment Service**     | –î–µ–ø–ª–æ–π                     | BullMQ, SSH management, Runner Agent               |
| **Infrastructure Service** | –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä–æ–π | –°–µ—Ä–≤–µ—Ä—ã, –∫–ª–∞—Å—Ç–µ—Ä—ã, —Å–∏—Å—Ç–µ–º–Ω—ã–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è            |
| **Billing Service**        | –ë–∏–ª–ª–∏–Ω–≥                    | Stripe, usage tracking, –ª–∏–º–∏—Ç—ã                     |

### –¢–µ—Ö–Ω–æ–ª–æ–≥–∏–∏

**Event Bus (Kafka):**

- Event sourcing –¥–ª—è –∏–∑–º–µ–Ω–µ–Ω–∏–π –≥—Ä–∞—Ñ–æ–≤
- CQRS —Å–æ–±—ã—Ç–∏—è –º–µ–∂–¥—É —Å–µ—Ä–≤–∏—Å–∞–º–∏
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ —Å–æ–±—ã—Ç–∏–π —á–µ—Ä–µ–∑ consumers
- –ì–∞—Ä–∞–Ω—Ç–∏—è –¥–æ—Å—Ç–∞–≤–∫–∏ —Å–æ–æ–±—â–µ–Ω–∏–π

**Databases (Multiple PostgreSQL):**

- –†–∞–∑–¥–µ–ª–µ–Ω–∏–µ –ø–æ –¥–æ–º–µ–Ω–∞–º: Graph, Codegen, Deployment
- Drizzle ORM –¥–ª—è —Ç–∏–ø–æ–±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏
- Protobuf –≤–∞–ª–∏–¥–∞—Ü–∏—è –¥–ª—è –∫–æ–Ω—Ç—Ä–∞–∫—Ç–æ–≤
- –ú–∏–≥—Ä–∞—Ü–∏–∏ —á–µ—Ä–µ–∑ Drizzle Kit

**Contracts (Protobuf):**

- –¢–∏–ø–æ–±–µ–∑–æ–ø–∞—Å–Ω–æ–µ –º–µ–∂—Å–µ—Ä–≤–∏—Å–Ω–æ–µ –æ–±—â–µ–Ω–∏–µ
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –≥–µ–Ω–µ—Ä–∞—Ü–∏—è TypeScript —Ç–∏–ø–æ–≤
- –í–µ—Ä—Å–∏–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ –∫–æ–Ω—Ç—Ä–∞–∫—Ç–æ–≤

**Auth (Better Auth):**

- –°–æ–≤—Ä–µ–º–µ–Ω–Ω–∞—è –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è
- Session management
- OAuth providers support

**Real-time (SSE):**

- Server-Sent Events –¥–ª—è –æ–±–Ω–æ–≤–ª–µ–Ω–∏–π –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏
- –û–±–Ω–æ–≤–ª–µ–Ω–∏—è –≥—Ä–∞—Ñ–æ–≤, –¥–µ–ø–ª–æ–µ–≤, –º–µ—Ç—Ä–∏–∫
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –ø–µ—Ä–µ–ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ

**Deployment (BullMQ):**

- –ù–∞–¥–µ–∂–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω—ã—Ö –∑–∞–¥–∞—á
- Retry –º–µ—Ö–∞–Ω–∏–∑–º
- –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –ø—Ä–æ–≥—Ä–µ—Å—Å–∞

**LLM Integration (OpenRouter):**

- –ï–¥–∏–Ω—ã–π API –¥–ª—è –¥–æ—Å—Ç—É–ø–∞ –∫ –º–Ω–æ–∂–µ—Å—Ç–≤—É –º–æ–¥–µ–ª–µ–π (OpenAI, Anthropic, Google, Mistral –∏ –¥—Ä.)
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π fallback –Ω–∞ –∞–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω—ã–µ –º–æ–¥–µ–ª–∏ –ø—Ä–∏ –æ—à–∏–±–∫–∞—Ö
- –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è –∏ —Å—Ç–æ–∏–º–æ—Å—Ç–∏
- –ì–∏–±–∫–∞—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –º–æ–¥–µ–ª–µ–π

–ü–æ–¥—Ä–æ–±–Ω–µ–µ: —Ä–∞–∑–¥–µ–ª "LLM –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —á–µ—Ä–µ–∑ OpenRouter" –Ω–∏–∂–µ

---

## –°–∏—Å—Ç–µ–º–∞ –º–µ—Ç—Ä–∏–∫ (—á–µ—Ä–µ–∑ Runner Agent)

–ú–µ—Ç—Ä–∏–∫–∏ —Å–æ–±–∏—Ä–∞—é—Ç—Å—è —á–µ—Ä–µ–∑ Runner Agent –Ω–∞ —Å–µ—Ä–≤–µ—Ä–∞—Ö –∫–ª–∏–µ–Ω—Ç–æ–≤ –∏ –æ—Ç–ø—Ä–∞–≤–ª—è—é—Ç—Å—è –≤ Control Plane —á–µ—Ä–µ–∑ gRPC.

**–ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞:**

```
Client Servers ‚Üí Runner Agent (Telemetry Collector) ‚Üí gRPC ‚Üí Metrics Ingestion Service ‚Üí TimescaleDB ‚Üí Frontend
```

**–°–±–æ—Ä –º–µ—Ç—Ä–∏–∫:**

- Runner Agent —Å–æ–±–∏—Ä–∞–µ—Ç –º–µ—Ç—Ä–∏–∫–∏ Docker Swarm –∏ —Å–∏—Å—Ç–µ–º–Ω—ã–µ –º–µ—Ç—Ä–∏–∫–∏ –∫–∞–∂–¥—ã–µ 10 —Å–µ–∫—É–Ω–¥
- –û—Ç–ø—Ä–∞–≤–∫–∞ –≤ Control Plane —á–µ—Ä–µ–∑ gRPC (—Ç–∏–ø–æ–±–µ–∑–æ–ø–∞—Å–Ω–æ —á–µ—Ä–µ–∑ Protobuf)
- –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –≤ TimescaleDB –¥–ª—è –≤—Ä–µ–º–µ–Ω–Ω—ã—Ö —Ä—è–¥–æ–≤
- Real-time –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ –≤ React Flow —á–µ—Ä–µ–∑ SSE

**–¢–∏–ø—ã –º–µ—Ç—Ä–∏–∫:**

- **–°–∏—Å—Ç–µ–º–Ω—ã–µ:** CPU, Memory, Network, Disk
- **Application:** RPS, Error Rate, Response Time, Health Status
- **Container:** Status, Restart Count, Uptime

**–•—Ä–∞–Ω–µ–Ω–∏–µ:**

- TimescaleDB —Å –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–º –ø–∞—Ä—Ç–∏—Ü–∏–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ–º
- –î–µ—Ç–∞–ª—å–Ω—ã–µ –º–µ—Ç—Ä–∏–∫–∏: 7 –¥–Ω–µ–π
- –ê–≥—Ä–µ–≥–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –º–µ—Ç—Ä–∏–∫–∏: 90 –¥–Ω–µ–π

---

## Kafka Integration

### –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ –∫–æ–º–º—É–Ω–∏–∫–∞—Ü–∏–∏

–í—Å–µ –º–∏–∫—Ä–æ—Å–µ—Ä–≤–∏—Å—ã –≤ Axion Stack –æ–±—â–∞—é—Ç—Å—è **—Ç–æ–ª—å–∫–æ —á–µ—Ä–µ–∑ Kafka**, –ø—Ä—è–º—ã–µ HTTP –≤—ã–∑–æ–≤—ã –º–µ–∂–¥—É —Å–µ—Ä–≤–∏—Å–∞–º–∏ –∑–∞–ø—Ä–µ—â–µ–Ω—ã.

**–ü—Ä–∞–≤–∏–ª–∞ –∫–æ–º–º—É–Ω–∏–∫–∞—Ü–∏–∏:**

- ‚úÖ **–ö–ª–∏–µ–Ω—Ç ‚Üí Traefik ‚Üí Service**: HTTP/WebSocket –∑–∞–ø—Ä–æ—Å—ã –æ—Ç –∫–ª–∏–µ–Ω—Ç–æ–≤
- ‚úÖ **Service ‚Üí Kafka ‚Üí Service**: –í—Å–µ –º–µ–∂—Å–µ—Ä–≤–∏—Å–Ω—ã–µ –∫–æ–º–º—É–Ω–∏–∫–∞—Ü–∏–∏ —á–µ—Ä–µ–∑ Kafka
- ‚úÖ **Service ‚Üí External APIs**: –í–Ω–µ—à–Ω–∏–µ API –≤—ã–∑–æ–≤—ã (OpenRouter, Docker Hub –∏ —Ç.–¥.)
- ‚ùå **Service ‚Üí Service (–ø—Ä—è–º–æ–π HTTP)**: –ó–∞–ø—Ä–µ—â–µ–Ω—ã –ø—Ä—è–º—ã–µ HTTP –≤—ã–∑–æ–≤—ã –º–µ–∂–¥—É —Å–µ—Ä–≤–∏—Å–∞–º–∏

### –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è

```bash
# Kafka brokers (—á–µ—Ä–µ–∑ –∑–∞–ø—è—Ç—É—é –¥–ª—è –∫–ª–∞—Å—Ç–µ—Ä–∞)
KAFKA_BROKERS=localhost:9092

# –ü–æ–¥–∞–≤–ª–µ–Ω–∏–µ –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–π KafkaJS
KAFKAJS_NO_PARTITIONER_WARNING=1
```

**–í–∞–∂–Ω–æ:**

- –ü—Ä–∏ –ª–æ–∫–∞–ª—å–Ω–æ–º –∑–∞–ø—É—Å–∫–µ —Å–µ—Ä–≤–∏—Å–∞ (–≤–Ω–µ Docker) –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ `localhost:9092`
- –ü—Ä–∏ –∑–∞–ø—É—Å–∫–µ —Å–µ—Ä–≤–∏—Å–∞ –≤ Docker –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ `kafka:9092`

### –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –≤ NestJS

**Server (–ø—Ä–∏–µ–º —Å–æ–æ–±—â–µ–Ω–∏–π):**

```typescript
import { createKafkaServerOptions } from "@axion/shared";

app.connectMicroservice<MicroserviceOptions>(
  createKafkaServerOptions(GRAPH_SERVICE_NAME, kafkaBrokers)
);
```

**Controller (–æ–±—Ä–∞–±–æ—Ç–∫–∞ —Å–æ–æ–±—â–µ–Ω–∏–π):**

```typescript
@MessagePattern(GRAPH_SERVICE_PATTERNS.CREATE_PROJECT)
async createProject(@Payload() data: CreateProjectRequest) {
  return this.graphService.createProject(data);
}
```

**Client (–æ—Ç–ø—Ä–∞–≤–∫–∞ —Å–æ–æ–±—â–µ–Ω–∏–π):**

```typescript
@Inject(GRAPH_SERVICE_NAME)
private readonly graphClient: ClientProxy

await this.graphClient
  .send(GRAPH_SERVICE_PATTERNS.CREATE_PROJECT, requestData)
  .toPromise();
```

---

## Traefik (edge routing)

### –†–æ–ª–∏ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤

**Traefik (edge router):**

- –ï–¥–∏–Ω–∞—è —Ç–æ—á–∫–∞ –≤—Ö–æ–¥–∞ –¥–ª—è –≤–Ω–µ—à–Ω–∏—Ö –∫–ª–∏–µ–Ω—Ç–æ–≤
- –ü—Ä–æ—Ç–æ–∫–æ–ª: HTTP/HTTPS, WebSocket
- –£—Ä–æ–≤–µ–Ω—å: –í–Ω–µ—à–Ω–∏–π (Client ‚Üí Service)

**Kafka (Event Bus):**

- –ú–µ–∂—Å–µ—Ä–≤–∏—Å–Ω–∞—è –∫–æ–º–º—É–Ω–∏–∫–∞—Ü–∏—è
- –ü—Ä–æ—Ç–æ–∫–æ–ª: Kafka Protocol (TCP)
- –£—Ä–æ–≤–µ–Ω—å: –í–Ω—É—Ç—Ä–µ–Ω–Ω–∏–π (Service ‚Üí Service)

**–í–∞–∂–Ω–æ:** Traefik –∏ Kafka –ù–ï –æ–±—â–∞—é—Ç—Å—è –Ω–∞–ø—Ä—è–º—É—é. –û–Ω–∏ —Ä–∞–±–æ—Ç–∞—é—Ç –Ω–∞ —Ä–∞–∑–Ω—ã—Ö —É—Ä–æ–≤–Ω—è—Ö –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—ã.

### Dynamic routing (Docker Provider)

Traefik –∏—Å–ø–æ–ª—å–∑—É–µ—Ç **Docker Provider** –¥–ª—è –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–æ–π –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ –∏ –º–∞—Ä—à—Ä—É—Ç–∏–∑–∞—Ü–∏–∏ —Å–µ—Ä–≤–∏—Å–æ–≤:

1. –ü–æ–¥–∫–ª—é—á–∞–µ—Ç—Å—è –∫ `/var/run/docker.sock` (read-only)
2. –û—Ç—Å–ª–µ–∂–∏–≤–∞–µ—Ç –∑–∞–ø—É—Å–∫/–æ—Å—Ç–∞–Ω–æ–≤–∫—É/–æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–æ–≤
3. –ß–∏—Ç–∞–µ—Ç Traefik labels –∏–∑ `docker-compose.yml`
4. –°–æ–∑–¥–∞–µ—Ç —Ä–æ—É—Ç–µ—Ä—ã –∏ —Å–µ—Ä–≤–∏—Å—ã –Ω–∞ –æ—Å–Ω–æ–≤–µ labels
5. –û–±–Ω–æ–≤–ª—è–µ—Ç –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏ –±–µ–∑ –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫–∞

**–¶–µ–Ω—Ç—Ä–∞–ª–∏–∑–æ–≤–∞–Ω–Ω–∞—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è:** `docker/services.config.ts`

```typescript
export const SERVICES_CONFIG = {
  [GRAPH_SERVICE_NAME]: {
    serviceName: GRAPH_SERVICE_NAME,
    dockerServiceName: "graph-service",
    routerName: "graph",
    host: "graph.localhost",
    port: 3001,
    websocket: true,
    healthCheckPath: "/health",
  },
};
```

**–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –≥–µ–Ω–µ—Ä–∞—Ü–∏—è labels:**

```bash
bun run docker:inject-labels
```

---

## LLM –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —á–µ—Ä–µ–∑ OpenRouter

### –û–±–∑–æ—Ä

Codegen Service –∏—Å–ø–æ–ª—å–∑—É–µ—Ç OpenRouter –¥–ª—è AI-powered –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –∫–æ–¥–∞ –º–∏–∫—Ä–æ—Å–µ—Ä–≤–∏—Å–æ–≤ –Ω–∞ –æ—Å–Ω–æ–≤–µ –≥—Ä–∞—Ñ–æ–≤ –∏–∑ Graph Service.

**–ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞ OpenRouter:**

- –ï–¥–∏–Ω—ã–π API –¥–ª—è –¥–æ—Å—Ç—É–ø–∞ –∫ –º–Ω–æ–∂–µ—Å—Ç–≤—É –º–æ–¥–µ–ª–µ–π (OpenAI, Anthropic, Google, Mistral –∏ –¥—Ä.)
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π fallback –Ω–∞ –∞–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω—ã–µ –º–æ–¥–µ–ª–∏ –ø—Ä–∏ –æ—à–∏–±–∫–∞—Ö
- –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è –∏ —Å—Ç–æ–∏–º–æ—Å—Ç–∏
- –ì–∏–±–∫–∞—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –º–æ–¥–µ–ª–µ–π

### –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è

```env
OPENROUTER_API_KEY=sk-or-v1-your-key-here
OPENROUTER_DEFAULT_MODEL=anthropic/claude-3.5-sonnet
```

**–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ:**

```typescript
// –ú–æ–¥–µ–ª—å –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é
await client.send(CODEGEN_SERVICE_PATTERNS.GENERATE_PROJECT, {
  projectId: "project-id",
  // aiModel –Ω–µ —É–∫–∞–∑–∞–Ω - –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è OPENROUTER_DEFAULT_MODEL
});

// –ö–æ–Ω–∫—Ä–µ—Ç–Ω–∞—è –º–æ–¥–µ–ª—å
await client.send(CODEGEN_SERVICE_PATTERNS.GENERATE_PROJECT, {
  projectId: "project-id",
  aiModel: "openai/gpt-4o", // ‚úÖ –õ—é–±–∞—è –º–æ–¥–µ–ª—å –∏–∑ openrouter.ai/models
});
```

### –ö–æ–º–ø–æ–Ω–µ–Ω—Ç—ã

**OpenRouterService:**

- –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è OpenRouter SDK –∫–ª–∏–µ–Ω—Ç–∞
- Non-streaming completions (–ø–æ–ª–Ω—ã–π –æ—Ç–≤–µ—Ç)
- Streaming completions (–ø–æ—Ç–æ–∫–æ–≤–∞—è –ø–µ—Ä–µ–¥–∞—á–∞)
- –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è

**PromptBuilderService:**

- –ü–æ—Å—Ç—Ä–æ–µ–Ω–∏–µ –ø—Ä–æ–º–ø—Ç–æ–≤ –∏–∑ –¥–∞–Ω–Ω—ã—Ö –≥—Ä–∞—Ñ–∞
- –°–∏—Å—Ç–µ–º–Ω—ã–π –ø—Ä–æ–º–ø—Ç —Å –ø—Ä–∞–≤–∏–ª–∞–º–∏ –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏
- –ü—Ä–æ–º–ø—Ç –¥–ª—è –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ —Å–µ—Ä–≤–∏—Å–∞
- –ü—Ä–æ–º–ø—Ç –¥–ª—è –≤–∞–ª–∏–¥–∞—Ü–∏–∏ –∫–æ–¥–∞

---

## üìö –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –†–µ—Å—É—Ä—Å—ã

- **[`ARCHITECTURE`](./ARCHITECTURE)** ‚Äî –ü–æ–ª–Ω–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ —Å–∏—Å—Ç–µ–º—ã
- **[`templates/`](./templates/)** ‚Äî –®–∞–±–ª–æ–Ω—ã –¥–ª—è –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –∫–æ–¥–∞
- **[`DEVELOPMENT_SETUP`](./DEVELOPMENT_SETUP)** ‚Äî –ù–∞—Å—Ç—Ä–æ–π–∫–∞ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏

---

_–≠—Ç–æ—Ç –¥–æ–∫—É–º–µ–Ω—Ç —Å–æ–¥–µ—Ä–∂–∏—Ç –∫–ª—é—á–µ–≤—ã–µ —Ç–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ –¥–µ—Ç–∞–ª–∏. –î–ª—è –ø–æ–ª–Ω–æ–π –∫–∞—Ä—Ç–∏–Ω—ã —Å–º. [`ARCHITECTURE`](./ARCHITECTURE)._

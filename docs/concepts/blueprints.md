---
title: "Blueprint System"
description: "Система шаблонов для генерации микросервисов с предопределенной архитектурой."
---

# Blueprint System

**Blueprint** — это спецификация архитектурного шаблона, которая определяет структуру сервиса, его инфраструктурные зависимости и правила генерации кода.

## Концепция

Вместо генерации кода "с нуля" по текстовому описанию, Axion использует детерминированные шаблоны. Пользователь выбирает тип сервиса (например, `Auth Blueprint` или `CRUD Blueprint`), а система разворачивает проверенную архитектуру.

*   **Детерминированная генерация (95%)**: Инфраструктура, Docker-контейнеры, конфигурация БД, GRPC/HTTP контракты и базовый код генерируются по жестким правилам.
*   **LLM Генерация (5%)**: Нейросеть заполняет только специфические блоки бизнес-логики в строго отведенных местах.

---

## Структура Blueprint

Каждый Blueprint состоит из следующих компонентов:

### 1. Файловая структура (File Structure)
Набор обязательных файлов и директорий. Используются Handlebars-шаблоны для подстановки имен переменных (названия сервисов, порты, имена баз данных). Файловая структура является неизменяемой (immutable), что гарантирует соблюдение архитектурных стандартов.

### 2. Точки генерации (Generation Points)
Маркеры в коде, указывающие места для вставки бизнес-логики, генерируемой LLM.

```typescript
// Пример точки генерации в шаблоне контроллера:
// {{#llm_point "create_order_validation"}}
//   // LLM сгенерирует код валидации здесь
// {{/llm_point}}
```

### 3. Инфраструктурная спецификация
Определяет необходимые ресурсы для сервиса:
- Тип базы данных (PostgreSQL, MongoDB).
- Необходимость кэширования (Redis).
- Очереди сообщений.
- UI-схема для настройки параметров сервиса в редакторе.

### 4. Правила контрактов
Логика автоматического создания `.proto` файлов. Blueprint знает, какие методы должен предоставлять сервис (например, `create`, `update`, `delete` для CRUD) и какие сообщения для этого нужны.

---

## Процесс генерации

1.  **Анализ графа**: Система определяет тип Blueprint для каждой ноды.
2.  **Сбор контекста**: Извлекаются связи (edges) и конфигурация ноды.
3.  **Scaffolding**: Разворачивается файловая структура из шаблонов.
4.  **Contract Generation**: Создаются Protobuf файлы.
5.  **Logic Injection**: LLM получает контекст и заполняет Generation Points.

## Типовые Blueprints

### CRUD Service
Стандартный микросервис для работы с сущностями.
- **Функции**: `findMany`, `findOne`, `create`, `update`, `delete`.
- **Генерация**: Автоматически создает Drizzle-схему на основе описанных полей.

### Auth Service
Сервис аутентификации и управления сессиями.
- **Функции**: Регистрация, вход, refresh token, валидация сессий.
- **Интеграции**: Поддержка OAuth провайдеров (Google, GitHub).

### Gateway Service
Точка входа (API Gateway).
- **Функции**: Маршрутизация запросов, агрегация ответов, rate limiting.

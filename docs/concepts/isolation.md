---
title: "Изоляция Проектов"
description: "Механизмы обеспечения полной изоляции проектов в Axion на уровне кода, сети и данных."
---

# Изоляция Проектов

В архитектуре Axion каждый проект является **полностью изолированным контуром**. Это архитектурное решение гарантирует, что сервисы и данные одного проекта не могут взаимодействовать с другими проектами без явной интеграции.

## Уровни изоляции

### 1. Database Isolation
*   **SaaS Level**: В базе данных Control Plane все записи разделены по `project_id`. Row-Level Security (RLS) или middleware на уровне приложения предотвращают доступ к чужим данным.
*   **Generated Services**: Каждый сгенерированный микросервис владеет собственной изолированной базой данных (или схемой), к которой имеет доступ только он.

### 2. Network Isolation
*   **Docker Networks**: Для каждого проекта при деплое создается отдельная overlay-сеть (например, `axion-project-{id}`).
*   **Service Discovery**: Механизмы обнаружения сервисов (DNS в Docker Swarm) работают только в пределах этой сети. Сервис `Auth` из Проекта А не может разрешить имя сервиса `Payment` из Проекта Б.

### 3. Resource Isolation
*   **Container Limits**: В конфигурации `docker-compose` / `docker stack` для каждого сервиса задаются жесткие лимиты CPU и RAM.
*   **Storage**: Используются отдельные Docker Volumes для персистентых данных.

### 4. Code Isolation
*   **Monorepo**: Каждый проект генерируется как независимый монорепозиторий.
*   **Contracts**: Protobuf-контракты уникальны для проекта.
*   **Dependencies**: `package.json` и `lock`-файлы генерируются независимо, предотвращая конфликты версий зависимостей между проектами.

---

## Идентификация сервисов

Связь между визуальным представлением и инфраструктурой осуществляется через `node_id`.

*   **Graph Node**: Каждая нода в редакторе имеет UUID.
*   **Service Metadata**: Этот UUID пробрасывается в метаданные сервиса и используется для Service Discovery внутри проекта.

```typescript
// Пример метаданных сервиса в реестре
interface ServiceMetadata {
  id: string;          // node_id
  projectId: string;   // project_id
  name: string;        // service-name
  network: string;     // network-name
}
```

## Управление состоянием (State Management)

При изменении графа и повторном деплое система выполняет дифференциальный анализ:

1.  **Create**: Для новых нод создаются новые сервисы и базы данных.
2.  **Delete**: Удаленные ноды приводят к остановке контейнеров и (опционально) архивации томов данных.
3.  **Update**: Изменение конфигурации вызывает rolling-update контейнеров без даунтайма (если возможно).

---
title: "Платформа и Генерируемые Сервисы"
description: "Архитектурные различия между Control Plane (NestJS) и сгенерированными сервисами (Elysia/Hono)."
---

# Платформа vs Генерируемые Сервисы

В экосистеме Axion используются два различных архитектурных подхода, оптимизированных под разные задачи: **Control Plane Architecture** (для платформы) и **Generated Microservices Architecture** (для пользовательских приложений).

## 1. SaaS Платформа (Control Plane)

Архитектура управляющего слоя Axion. Рассчитана на сложную бизнес-логику, надежность и масштабируемость команды разработки.

*   **Фреймворк**: NestJS (модульная архитектура, DI).
*   **Коммуникация**: Kafka (Event Bus) для асинхронных событий + gRPC для критических вызовов.
*   **База данных**: Единый кластер PostgreSQL с разделением по схемам/таблицам.
*   **Задачи**: Биллинг, генерация кода, управление инфраструктурой, аутентификация.

## 2. Генерируемые Сервисы (User Projects)

Архитектура приложений, которые создает пользователь. Рассчитана на максимальную производительность, низкое потребление ресурсов и простоту (KISS).

*   **Фреймворк**: ElysiaJS или Hono (High-performance Runtime).
*   **Коммуникация**: HTTP RPC (прямые вызовы service-to-service внутри кластера).
*   **База данных**: Pattern "Database-per-Service". Каждый микросервис владеет своей БД.
*   **Особенности**:
    *   **Cold Start**: < 50ms.
    *   **Memory Footprint**: ~30-50 MB на инстанс.
    *   **No Magic**: Минимум абстракций, прямой доступ к Drizzle ORM.

---

## Сравнительная таблица

| Характеристика | Control Plane (SaaS) | Generated Services (User) |
| :--- | :--- | :--- |
| **Стек** | NestJS + TypeScript | ElysiaJS/Hono + TypeScript |
| **Межсервисное взаимодействие** | Kafka (Event-Driven) | HTTP RPC (Direct Sync) |
| **Service Discovery** | Внешний (Consul/K8s) | Docker Swarm DNS |
| **База данных** | Shared PostgreSQL | Isolated DB per Service |
| **ORM** | Drizzle | Drizzle |
| **API Gateway** | Traefik (Central) | Traefik (Project Level) |
| **Время старта** | 5-10 сек | < 1 сек |

## Принципы выбора

Мы не используем NestJS для генерируемых сервисов по следующим причинам:
1.  **Избыточность**: Для типичного микросервиса (CRUD) NestJS создает слишком много бойлерплейта.
2.  **Сложность генерации**: Генерировать валидный Dependency Injection граф сложнее, чем плоскую структуру функций-хендлеров.
3.  **Ресурсоемкость**: Пользователи часто запускают проекты на дешевых VPS. Легковесные рантаймы позволяют запустить 20 микросервисов там, где NestJS запустил бы только 3.

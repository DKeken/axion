---
title: "BullMQ Metrics & Observability"
description: "–ú–µ—Ç—Ä–∏–∫–∏ –∏ –Ω–∞–±–ª—é–¥–∞–µ–º–æ—Å—Ç—å –¥–ª—è BullMQ –æ—á–µ—Ä–µ–¥–µ–π"
order: 10
---

# BullMQ Metrics & Observability

Axion Stack –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è–µ—Ç —Å—Ç–∞–Ω–¥–∞—Ä—Ç–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –º–µ—Ç—Ä–∏–∫–∏ –¥–ª—è –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞ BullMQ –æ—á–µ—Ä–µ–¥–µ–π.

## üìã –ú–µ—Ç—Ä–∏–∫–∏ –æ—á–µ—Ä–µ–¥–µ–π

### –ë–∞–∑–æ–≤—ã–µ –º–µ—Ç—Ä–∏–∫–∏

```typescript
import { getQueueMetrics } from "@axion/nestjs-common";

const metrics = await getQueueMetrics(queue);
// {
//   queueName: "deployment-queue",
//   active: 2,
//   waiting: 5,
//   delayed: 0,
//   completed: 100,
//   failed: 3,
//   paused: false,
//   timestamp: 1234567890
// }
```

### –†–∞—Å—à–∏—Ä–µ–Ω–Ω—ã–µ –º–µ—Ç—Ä–∏–∫–∏

```typescript
import { getQueueMetricsSummary } from "@axion/nestjs-common";

const summary = await getQueueMetricsSummary(queue);
// {
//   ...base metrics,
//   total: 7, // active + waiting + delayed
//   successRate: 0.97, // completed / (completed + failed)
//   averageDuration: 45000 // —Å—Ä–µ–¥–Ω–µ–µ –≤—Ä–µ–º—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è (ms)
// }
```

### –ú–µ—Ç—Ä–∏–∫–∏ jobs

```typescript
import { getJobMetrics, getJobsMetrics } from "@axion/nestjs-common";

// –ú–µ—Ç—Ä–∏–∫–∏ –æ–¥–Ω–æ–≥–æ job
const jobMetrics = await getJobMetrics(job);
// {
//   jobId: "123",
//   name: "deploy",
//   state: "completed",
//   duration: 45000,
//   attempts: 1,
//   progress: 100,
//   createdAt: 1234567890,
//   processedAt: 1234567900,
//   completedAt: 1234567935
// }

// –ú–µ—Ç—Ä–∏–∫–∏ –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö jobs
const jobsMetrics = await getJobsMetrics(jobs);
```

## üîß HTTP Endpoints

### –ü—Ä–∏–º–µ—Ä —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏ –∫–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä–∞

```typescript
import { Controller, Get, Param } from "@nestjs/common";
import { InjectQueue } from "@nestjs/bullmq";
import { Queue } from "bullmq";
import { getQueueMetricsSummary } from "@axion/nestjs-common";

@Controller("internal/metrics/bullmq")
export class QueueMetricsController {
  constructor(
    @InjectQueue(QUEUE_NAMES.DEPLOYMENT)
    private readonly deploymentQueue: Queue
  ) {}

  @Get("deployment")
  async getDeploymentMetrics() {
    return getQueueMetricsSummary(this.deploymentQueue);
  }
}
```

## üìä –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –º–µ—Ç—Ä–∏–∫

### –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –∑–¥–æ—Ä–æ–≤—å—è –æ—á–µ—Ä–µ–¥–∏

```typescript
const metrics = await getQueueMetricsSummary(queue);

// –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞ –∑–∞—Å—Ç—Ä—è–≤—à–∏–µ jobs
if (metrics.active > 10 && metrics.delayed === 0) {
  logger.warn(`Queue ${metrics.queueName} has ${metrics.active} active jobs`);
}

// –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞ –≤—ã—Å–æ–∫—É—é —á–∞—Å—Ç–æ—Ç—É –æ—à–∏–±–æ–∫
if (metrics.successRate < 0.95) {
  logger.error(
    `Queue ${metrics.queueName} has low success rate: ${metrics.successRate}`
  );
}

// –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞ –Ω–∞–∫–æ–ø–ª–µ–Ω–∏–µ jobs
if (metrics.waiting > 100) {
  logger.warn(`Queue ${metrics.queueName} has ${metrics.waiting} waiting jobs`);
}
```

### –û—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏–µ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏

```typescript
// –°—Ä–µ–¥–Ω–µ–µ –≤—Ä–µ–º—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è
if (metrics.averageDuration) {
  logger.log(
    `Queue ${metrics.queueName} average duration: ${metrics.averageDuration}ms`
  );
}

// –°–∫–æ—Ä–æ—Å—Ç—å –æ–±—Ä–∞–±–æ—Ç–∫–∏
const throughput = metrics.completed / timeWindow;
logger.log(`Queue ${metrics.queueName} throughput: ${throughput} jobs/sec`);
```

## üîó –°–º. —Ç–∞–∫–∂–µ

- [BullMQ Standardization](./BULLMQ_STANDARDIZATION.mdx) - —Å—Ç–∞–Ω–¥–∞—Ä—Ç–∏–∑–∞—Ü–∏—è BullMQ
- [API Reference](./API_REFERENCE.mdx) - HTTP API –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è
- [Architecture](./ARCHITECTURE.mdx) - –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ —Å–∏—Å—Ç–µ–º—ã

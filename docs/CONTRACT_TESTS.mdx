---
title: "Contract Tests"
description: "–¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç–∏ Protobuf –∫–æ–Ω—Ç—Ä–∞–∫—Ç–æ–≤"
order: 12
---

# Contract Tests

Contract tests –ø—Ä–æ–≤–µ—Ä—è—é—Ç —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å Protobuf –∫–æ–Ω—Ç—Ä–∞–∫—Ç–æ–≤ –º–µ–∂–¥—É –≤–µ—Ä—Å–∏—è–º–∏ –∏ –≥–∞—Ä–∞–Ω—Ç–∏—Ä—É—é—Ç, —á—Ç–æ –∏–∑–º–µ–Ω–µ–Ω–∏—è –Ω–µ –ª–æ–º–∞—é—Ç —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–µ –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏.

## üìã –¶–µ–ª—å

Contract tests –æ–±–µ—Å–ø–µ—á–∏–≤–∞—é—Ç:

- **–û–±—Ä–∞—Ç–Ω—É—é —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å** - —Å—Ç–∞—Ä—ã–µ –∫–ª–∏–µ–Ω—Ç—ã —Ä–∞–±–æ—Ç–∞—é—Ç —Å –Ω–æ–≤—ã–º–∏ —Å–µ—Ä–≤–µ—Ä–∞–º–∏
- **–ü–µ—Ä–µ–¥–Ω—é—é —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å** - –Ω–æ–≤—ã–µ –∫–ª–∏–µ–Ω—Ç—ã —Ä–∞–±–æ—Ç–∞—é—Ç —Å–æ —Å—Ç–∞—Ä—ã–º–∏ —Å–µ—Ä–≤–µ—Ä–∞–º–∏
- **–í–∞–ª–∏–¥–∞—Ü–∏—é —Å—Ö–µ–º** - –ø—Ä–æ–≤–µ—Ä–∫–∞ –ø—Ä–∞–≤–∏–ª—å–Ω–æ—Å—Ç–∏ proto —Ñ–∞–π–ª–æ–≤
- **–†–µ–≥—Ä–µ—Å—Å–∏–∏** - –æ–±–Ω–∞—Ä—É–∂–µ–Ω–∏–µ breaking changes

## üèóÔ∏è –°—Ç—Ä—É–∫—Ç—É—Ä–∞ —Ç–µ—Å—Ç–æ–≤

```
tests/
‚îú‚îÄ‚îÄ contracts/
‚îÇ   ‚îú‚îÄ‚îÄ setup.ts              # –ù–∞—Å—Ç—Ä–æ–π–∫–∞ —Ç–µ—Å—Ç–æ–≤
‚îÇ   ‚îú‚îÄ‚îÄ compatibility.test.ts # –¢–µ—Å—Ç—ã —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç–∏
‚îÇ   ‚îú‚îÄ‚îÄ validation.test.ts    # –í–∞–ª–∏–¥–∞—Ü–∏—è —Å—Ö–µ–º
‚îÇ   ‚îî‚îÄ‚îÄ fixtures/             # –¢–µ—Å—Ç–æ–≤—ã–µ –¥–∞–Ω–Ω—ã–µ
‚îÇ       ‚îú‚îÄ‚îÄ requests/         # –ü—Ä–∏–º–µ—Ä—ã request —Å–æ–æ–±—â–µ–Ω–∏–π
‚îÇ       ‚îî‚îÄ‚îÄ responses/        # –ü—Ä–∏–º–µ—Ä—ã response —Å–æ–æ–±—â–µ–Ω–∏–π
```

## üîß –ü—Ä–∏–º–µ—Ä—ã —Ç–µ—Å—Ç–æ–≤

### Backward Compatibility

```typescript
// tests/contracts/compatibility.test.ts
import { CreateProjectRequest } from "@axion/contracts";
import { createRequestMetadata } from "@axion/contracts";

test("CreateProjectRequest backward compatibility", () => {
  // –°—Ç–∞—Ä–∞—è –≤–µ—Ä—Å–∏—è (–º–∏–Ω–∏–º–∞–ª—å–Ω—ã–µ –ø–æ–ª—è)
  const oldRequest: CreateProjectRequest = {
    metadata: createRequestMetadata("user-123"),
    name: "Project Name",
  };

  // –î–æ–ª–∂–Ω–æ –≤–∞–ª–∏–¥–∏—Ä–æ–≤–∞—Ç—å—Å—è —Å –Ω–æ–≤–æ–π –≤–µ—Ä—Å–∏–µ–π
  expect(oldRequest).toBeDefined();
  expect(oldRequest.name).toBe("Project Name");

  // –ù–æ–≤—ã–µ optional –ø–æ–ª—è –¥–æ–ª–∂–Ω—ã –æ—Ç—Å—É—Ç—Å—Ç–≤–æ–≤–∞—Ç—å, –Ω–æ —ç—Ç–æ –Ω–µ –æ—à–∏–±–∫–∞
  expect(oldRequest.description).toBeUndefined();
});

test("CreateProjectRequest forward compatibility", () => {
  // –ù–æ–≤–∞—è –≤–µ—Ä—Å–∏—è (—Å –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–º–∏ –ø–æ–ª—è–º–∏)
  const newRequest: CreateProjectRequest = {
    metadata: createRequestMetadata("user-123"),
    name: "Project Name",
    description: "Project Description", // –ù–æ–≤–æ–µ –ø–æ–ª–µ
    tags: ["tag1", "tag2"], // –ù–æ–≤–æ–µ –ø–æ–ª–µ
  };

  // –î–æ–ª–∂–Ω–æ —Ä–∞–±–æ—Ç–∞—Ç—å —Å–æ —Å—Ç–∞—Ä—ã–º–∏ —Å–µ—Ä–≤–µ—Ä–∞–º–∏
  // –°—Ç–∞—Ä—ã–µ —Å–µ—Ä–≤–µ—Ä—ã –ø—Ä–æ—Å—Ç–æ –ø—Ä–æ–∏–≥–Ω–æ—Ä–∏—Ä—É—é—Ç –Ω–æ–≤—ã–µ –ø–æ–ª—è
  expect(newRequest.name).toBe("Project Name");
  expect(newRequest.description).toBe("Project Description");
});
```

### Schema Validation

```typescript
// tests/contracts/validation.test.ts
import {
  CreateProjectRequest,
  GetProjectRequest,
  UpdateProjectRequest,
} from "@axion/contracts";

test("Required fields validation", () => {
  // metadata –¥–æ–ª–∂–Ω–æ –±—ã—Ç—å –æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–º
  expect(() => {
    const request: CreateProjectRequest = {
      // @ts-expect-error - metadata is required
      name: "Project",
    };
  }).toThrow();
});

test("Optional fields handling", () => {
  const request: CreateProjectRequest = {
    metadata: createRequestMetadata("user-123"),
    name: "Project",
    // description - optional, –º–æ–∂–Ω–æ –Ω–µ —É–∫–∞–∑—ã–≤–∞—Ç—å
  };

  expect(request.name).toBe("Project");
  expect(request.description).toBeUndefined();
});
```

### Message Pattern Consistency

```typescript
// tests/contracts/patterns.test.ts
import { GRAPH_SERVICE_PATTERNS } from "@axion/contracts";

test("Message patterns are defined", () => {
  expect(GRAPH_SERVICE_PATTERNS.CREATE_PROJECT).toBeDefined();
  expect(GRAPH_SERVICE_PATTERNS.GET_PROJECT).toBeDefined();
  expect(GRAPH_SERVICE_PATTERNS.UPDATE_PROJECT).toBeDefined();
});

test("Message patterns follow naming convention", () => {
  // –í—Å–µ –ø–∞—Ç—Ç–µ—Ä–Ω—ã –¥–æ–ª–∂–Ω—ã —Å–ª–µ–¥–æ–≤–∞—Ç—å —Ñ–æ—Ä–º–∞—Ç—É: "{service}.{action}"
  const pattern = GRAPH_SERVICE_PATTERNS.CREATE_PROJECT;
  expect(pattern).toMatch(/^graph-service\./);
});
```

## üöÄ –ó–∞–ø—É—Å–∫ —Ç–µ—Å—Ç–æ–≤

```bash
# –ó–∞–ø—É—Å—Ç–∏—Ç—å –≤—Å–µ contract tests
bun test tests/contracts

# –ó–∞–ø—É—Å—Ç–∏—Ç—å —Ç–æ–ª—å–∫–æ compatibility tests
bun test tests/contracts/compatibility.test.ts

# –ó–∞–ø—É—Å—Ç–∏—Ç—å —Å coverage
bun test --coverage tests/contracts
```

## üìù Best Practices

1. **–¢–µ—Å—Ç–∏—Ä—É–π—Ç–µ –º–∏–Ω–∏–º–∞–ª—å–Ω—ã–µ –≤–µ—Ä—Å–∏–∏** - –ø—Ä–æ–≤–µ—Ä—è–π—Ç–µ, —á—Ç–æ –º–∏–Ω–∏–º–∞–ª—å–Ω—ã–µ payload —Ä–∞–±–æ—Ç–∞—é—Ç
2. **–¢–µ—Å—Ç–∏—Ä—É–π—Ç–µ —Ä–∞—Å—à–∏—Ä–µ–Ω–Ω—ã–µ –≤–µ—Ä—Å–∏–∏** - –ø—Ä–æ–≤–µ—Ä—è–π—Ç–µ, —á—Ç–æ –Ω–æ–≤—ã–µ –ø–æ–ª—è –Ω–µ –ª–æ–º–∞—é—Ç —Å—Ç–∞—Ä—ã–µ —Å–µ—Ä–≤–µ—Ä—ã
3. **–í–∞–ª–∏–¥–∏—Ä—É–π—Ç–µ required fields** - —É–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–µ –ø–æ–ª—è –¥–µ–π—Å—Ç–≤–∏—Ç–µ–ª—å–Ω–æ –æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã
4. **–ü—Ä–æ–≤–µ—Ä—è–π—Ç–µ —Ç–∏–ø—ã** - –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ TypeScript –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ —Ç–∏–ø–æ–≤
5. **–î–æ–∫—É–º–µ–Ω—Ç–∏—Ä—É–π—Ç–µ breaking changes** - –∫–æ–≥–¥–∞ –¥–µ–ª–∞–µ—Ç–µ breaking change, –æ–±–Ω–æ–≤–∏—Ç–µ —Ç–µ—Å—Ç—ã

## üîó –°–º. —Ç–∞–∫–∂–µ

- [Protobuf Versioning](./PROTOBUF_VERSIONING.mdx) - –ø–æ–ª–∏—Ç–∏–∫–∞ –≤–µ—Ä—Å–∏–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏—è
- [Contracts & Validation](./CONTRACTS_AND_VALIDATION.mdx) - –æ–±—â–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è
- [E2E Testing](./E2E_TESTING.mdx) - end-to-end —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

---
title: "End-to-End Testing"
description: "–†—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ –ø–æ E2E —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—é –ø–æ–ª–Ω–æ–≥–æ workflow Axion Stack"
order: 9
---

# End-to-End Testing

Axion Stack –∏—Å–ø–æ–ª—å–∑—É–µ—Ç E2E —Ç–µ—Å—Ç—ã –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ –ø–æ–ª–Ω–æ–≥–æ workflow –æ—Ç —Å–æ–∑–¥–∞–Ω–∏—è –ø—Ä–æ–µ–∫—Ç–∞ –¥–æ –¥–µ–ø–ª–æ—è.

## üìã –û–±–∑–æ—Ä

E2E —Ç–µ—Å—Ç—ã –ø—Ä–æ–≤–µ—Ä—è—é—Ç –ø–æ–ª–Ω—ã–π happy-path workflow:

1. **Project/Graph** - —Å–æ–∑–¥–∞–Ω–∏–µ –ø—Ä–æ–µ–∫—Ç–∞ –∏ –≥—Ä–∞—Ñ–∞
2. **Generate** - –≥–µ–Ω–µ—Ä–∞—Ü–∏—è –∫–æ–¥–∞ –∏–∑ –≥—Ä–∞—Ñ–∞
3. **Validate** - –≤–∞–ª–∏–¥–∞—Ü–∏—è —Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω–Ω–æ–≥–æ –∫–æ–¥–∞
4. **Deploy** - –¥–µ–ø–ª–æ–π –ø—Ä–æ–µ–∫—Ç–∞
5. **Status** - –ø—Ä–æ–≤–µ—Ä–∫–∞ —Å—Ç–∞—Ç—É—Å–∞ –¥–µ–ø–ª–æ—è
6. **Rollback** - –æ—Ç–∫–∞—Ç –¥–µ–ø–ª–æ—è

## üèóÔ∏è –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ —Ç–µ—Å—Ç–æ–≤

### –¢–µ—Å—Ç–æ–≤–∞—è –∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä–∞

E2E —Ç–µ—Å—Ç—ã –∏—Å–ø–æ–ª—å–∑—É—é—Ç:

- **Test Database** - –æ—Ç–¥–µ–ª—å–Ω–∞—è –ë–î –¥–ª—è —Ç–µ—Å—Ç–æ–≤
- **Test Kafka** - –∏–∑–æ–ª–∏—Ä–æ–≤–∞–Ω–Ω—ã–π Kafka –¥–ª—è —Ç–µ—Å—Ç–æ–≤
- **Test Redis** - –æ—Ç–¥–µ–ª—å–Ω—ã–π Redis –¥–ª—è BullMQ
- **HTTP Client** - –¥–ª—è –≤—ã–∑–æ–≤–æ–≤ —á–µ—Ä–µ–∑ Traefik
- **SSE Client** - –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ –ø—Ä–æ–≥—Ä–µ—Å—Å–∞ —á–µ—Ä–µ–∑ SSE

### –°—Ç—Ä—É–∫—Ç—É—Ä–∞ —Ç–µ—Å—Ç–æ–≤

```
tests/
‚îú‚îÄ‚îÄ e2e/
‚îÇ   ‚îú‚îÄ‚îÄ setup.ts              # –ù–∞—Å—Ç—Ä–æ–π–∫–∞ —Ç–µ—Å—Ç–æ–≤–æ–π –∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä—ã
‚îÇ   ‚îú‚îÄ‚îÄ helpers/              # –í—Å–ø–æ–º–æ–≥–∞—Ç–µ–ª—å–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ client.ts        # HTTP –∫–ª–∏–µ–Ω—Ç—ã
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ auth.ts          # –ê—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ cleanup.ts       # –û—á–∏—Å—Ç–∫–∞ –ø–æ—Å–ª–µ —Ç–µ—Å—Ç–æ–≤
‚îÇ   ‚îú‚îÄ‚îÄ workflows/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ project-flow.test.ts    # –ü–æ–ª–Ω—ã–π workflow –ø—Ä–æ–µ–∫—Ç–∞
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ deployment-flow.test.ts # Workflow –¥–µ–ø–ª–æ—è
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ rollback-flow.test.ts   # Workflow –æ—Ç–∫–∞—Ç–∞
‚îÇ   ‚îî‚îÄ‚îÄ fixtures/            # –¢–µ—Å—Ç–æ–≤—ã–µ –¥–∞–Ω–Ω—ã–µ
‚îÇ       ‚îú‚îÄ‚îÄ graph.json       # –ü—Ä–∏–º–µ—Ä –≥—Ä–∞—Ñ–∞
‚îÇ       ‚îî‚îÄ‚îÄ services.json    # –ü—Ä–∏–º–µ—Ä —Å–µ—Ä–≤–∏—Å–æ–≤
```

## üîß –ù–∞—Å—Ç—Ä–æ–π–∫–∞

### Environment Variables

–°–æ–∑–¥–∞–π—Ç–µ `.env.test` —Ñ–∞–π–ª:

```bash
# Database
POSTGRES_URL=postgresql://test:test@localhost:5432/axion_test

# Kafka
KAFKA_BROKERS=localhost:9093

# Redis
REDIS_URL=redis://localhost:6380

# Services
GRAPH_SERVICE_PORT=3101
CODEGEN_SERVICE_PORT=3102
DEPLOYMENT_SERVICE_PORT=3105
INFRASTRUCTURE_SERVICE_PORT=3104

# Test
TEST_USER_ID=test-user-123
TEST_PROJECT_ID=test-project-456
```

### Test Setup

```typescript
// tests/e2e/setup.ts
import { beforeAll, afterAll } from "bun:test";

beforeAll(async () => {
  // 1. –ó–∞–ø—É—Å—Ç–∏—Ç—å —Ç–µ—Å—Ç–æ–≤—É—é –∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä—É (Docker)
  // 2. –ü–æ–¥–æ–∂–¥–∞—Ç—å –≥–æ—Ç–æ–≤–Ω–æ—Å—Ç–∏ —Å–µ—Ä–≤–∏—Å–æ–≤
  // 3. –°–æ–∑–¥–∞—Ç—å —Ç–µ—Å—Ç–æ–≤–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
  // 4. –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞—Ç—å —Ç–µ—Å—Ç–æ–≤—ã–µ –¥–∞–Ω–Ω—ã–µ
});

afterAll(async () => {
  // 1. –û—á–∏—Å—Ç–∏—Ç—å —Ç–µ—Å—Ç–æ–≤—ã–µ –¥–∞–Ω–Ω—ã–µ
  // 2. –û—Å—Ç–∞–Ω–æ–≤–∏—Ç—å —Ç–µ—Å—Ç–æ–≤—É—é –∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä—É
});
```

## üìù –ü—Ä–∏–º–µ—Ä—ã —Ç–µ—Å—Ç–æ–≤

### Happy Path Workflow

```typescript
// tests/e2e/workflows/project-flow.test.ts
import { test, expect, beforeAll } from "bun:test";
import { createTestClient, createTestAuth } from "../helpers/client";

test("Full project workflow", async () => {
  const client = await createTestClient();
  const auth = await createTestAuth(client);

  // 1. Create Project
  const project = await client.post("/api/v1/graph/projects", {
    name: "test-project",
    metadata: auth.metadata,
  });
  expect(project.status).toBe(200);
  const projectId = project.data.id;

  // 2. Create Graph
  const graph = await client.post(`/api/v1/graph/projects/${projectId}/graph`, {
    graphData: testGraphData,
    metadata: auth.metadata,
  });
  expect(graph.status).toBe(200);

  // 3. Generate Code
  const generateResponse = await client.post(
    `/api/v1/codegen/projects/${projectId}/generate`,
    {
      metadata: auth.metadata,
    }
  );
  expect(generateResponse.status).toBe(200);

  // 4. Wait for Generation
  await waitForGeneration(projectId, client, auth);

  // 5. Validate Code
  const validateResponse = await client.post(
    `/api/v1/codegen/projects/${projectId}/validate`,
    {
      metadata: auth.metadata,
    }
  );
  expect(validateResponse.status).toBe(200);
  expect(validateResponse.data.valid).toBe(true);

  // 6. Deploy (requires infrastructure)
  // ...

  // 7. Check Status
  // ...

  // 8. Rollback
  // ...
});
```

### SSE Progress Test

```typescript
test("SSE progress updates", async () => {
  const client = await createTestClient();
  const auth = await createTestAuth(client);

  // Start generation
  const generateResponse = await client.post(
    `/api/v1/codegen/projects/${projectId}/generate`,
    {
      metadata: auth.metadata,
    }
  );

  // Connect to SSE endpoint
  const events = await connectSSE(
    `/api/v1/graph/projects/${projectId}/status`,
    auth.token
  );

  const progressEvents: string[] = [];
  events.on("message", (event) => {
    progressEvents.push(event.data);
  });

  // Wait for completion
  await waitForEvent(events, "complete", 60000);

  expect(progressEvents.length).toBeGreaterThan(0);
  expect(progressEvents).toContainEqual(
    expect.objectContaining({
      type: "progress",
      progress: expect.any(Number),
    })
  );
});
```

## üîç Best Practices

1. **–ò–∑–æ–ª–∏—Ä—É–π—Ç–µ —Ç–µ—Å—Ç—ã** - –∫–∞–∂–¥—ã–π —Ç–µ—Å—Ç –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å –Ω–µ–∑–∞–≤–∏—Å–∏–º—ã–º
2. **–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ fixtures** - –ø—Ä–µ–¥–æ–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –¥–ª—è —Ç–µ—Å—Ç–æ–≤
3. **–û—á–∏—â–∞–π—Ç–µ –ø–æ—Å–ª–µ —Ç–µ—Å—Ç–æ–≤** - —É–¥–∞–ª—è–π—Ç–µ —Å–æ–∑–¥–∞–Ω–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ
4. **–ü—Ä–æ–≤–µ—Ä—è–π—Ç–µ —Å—Ç–∞—Ç—É—Å—ã** - –≤–∞–ª–∏–¥–∏—Ä—É–π—Ç–µ HTTP —Å—Ç–∞—Ç—É—Å—ã –∏ response —Ñ–æ—Ä–º–∞—Ç
5. **–¢–µ—Å—Ç–∏—Ä—É–π—Ç–µ –æ—à–∏–±–∫–∏** - –ø—Ä–æ–≤–µ—Ä—è–π—Ç–µ –æ–±—Ä–∞–±–æ—Ç–∫—É –æ—à–∏–±–æ–∫

## üöÄ –ó–∞–ø—É—Å–∫ —Ç–µ—Å—Ç–æ–≤

```bash
# –ó–∞–ø—É—Å—Ç–∏—Ç—å –≤—Å–µ E2E —Ç–µ—Å—Ç—ã
bun test tests/e2e

# –ó–∞–ø—É—Å—Ç–∏—Ç—å –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–π —Ç–µ—Å—Ç
bun test tests/e2e/workflows/project-flow.test.ts

# –ó–∞–ø—É—Å—Ç–∏—Ç—å —Å coverage
bun test --coverage tests/e2e
```

## üîó –°–º. —Ç–∞–∫–∂–µ

- [API Reference](./API_REFERENCE.mdx) - –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è API
- [Architecture](./ARCHITECTURE.mdx) - –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ —Å–∏—Å—Ç–µ–º—ã
- [Development Setup](./DEVELOPMENT_SETUP.md) - –Ω–∞—Å—Ç—Ä–æ–π–∫–∞ –æ–∫—Ä—É–∂–µ–Ω–∏—è
